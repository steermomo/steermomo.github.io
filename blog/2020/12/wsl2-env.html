<!DOCTYPE html>
<html lang="en">

<head>
        <meta name="google-site-verification" content="d0pvXqLPH8JyCfWVyhZ7njhGUndRFIR95YM3myMb7rU" />
        <meta charset="utf-8" />
        <meta http-equiv="Cache-Control" content="no-transform" />
        <meta http-equiv="Cache-Control" content="no-siteapp" />
        <meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=yes" />
        <title>WSL2ç¯å¢ƒè¸©å‘é…ç½®</title>
        <link rel="stylesheet" href="/theme/css/main.css" />

        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
        <script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>


        <link rel="stylesheet" href="//unpkg.com/heti/umd/heti.min.css">

</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <!-- <h1><a href="/">steer </a></h1> -->
                <nav>
                        <ul>
                                <li><a href="/">ğŸ¦‰</a></li>
                                <li><a href="/blog">Blog</a></li>
                                <li><a href="/archives">Archives</a></li>
                                <li><a href="/gallery">Gallery</a></li>
                                <li id="navName">steer </li>
                        </ul>
                </nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/blog/2020/12/wsl2-env" rel="bookmark" title="Permalink to WSL2ç¯å¢ƒè¸©å‘é…ç½®">WSL2ç¯å¢ƒè¸©å‘é…ç½®</a>
      </h1>
    </header>

    <div class="entry-content">
<div class="post-meta">
        Date: <span >
               2020-12-24 Thu
        </span>
<span>Category: <a href="/category/misc/">MISC</a></span>
<!-- <p>tags: <a href="/tags/wsl2/">WSL2</a> <a href="/tags/linux/">Linux</a> </p> -->

</div><!-- /.post-info -->

      <p>è¿™ä¸¤å¤©è£…äº†å¥½å‡ éWSL2... æ¯æ¬¡éƒ½æ˜¯è¦é‡æ–°é…ç½®ç¯å¢ƒï¼Œå¼€ä¸ªé¡µé¢é›†ä¸­è®°å½•ä¸€ä¸‹åšäº†å“ªäº›é…ç½®ï¼Œå…å¾—åˆå¾—å¼€å¾ˆå¤šé¡µé¢å»æ‰¾é…ç½®é¡¹</p>
<p><img alt="" src="/images/wsl2-neofetch.png"></p>
<h2>è§£å†³WSL2 DNSè§£æé—®é¢˜</h2>
<p>åœ¨å…¬å¸çš„å†…ç½‘ç¯å¢ƒä¸‹ï¼ŒWindowsçš„å‡çº§éƒ½æ˜¯ç”±å†…éƒ¨ç®¡ç†çš„ï¼Œä¹‹å‰ä¸€ç›´æ²¡æ³•å‡çº§åˆ°æ”¯æŒWSL2çš„ç‰ˆæœ¬ã€‚</p>
<p>åœ¨å‡ æ¬¡æ›´æ–°åï¼Œç»ˆäºç”¨ä¸Šäº†WSL2ï¼Œä½†æ˜¯å°†WSL1è½¬ä¸ºWSL2ä¹‹åï¼ŒDNSè§£æå‡ºç°äº†é—®é¢˜ã€‚åœ¨WSL2å†…æ˜¯æœ‰ç½‘ç»œçš„ï¼Œpingå…¶ä»–çš„ipåœ°å€éƒ½æ²¡æœ‰é—®é¢˜ï¼Œéœ€è¦è§£æåŸŸåçš„æ—¶å€™å°±æŒ‚äº†ï¼Œ
è¿™é‡Œåº”è¯¥æ˜¯å†…ç½‘çš„ä¸€äº›ç½‘ç»œé…ç½®ä¸WSL2çš„ç½‘ç»œé…ç½®æœ‰ä¸ä¸€è‡´çš„åœ°æ–¹ã€‚</p>
<p>ååå¤å¤å°†WSL2é‡è£…äº†å‡ æ¬¡éƒ½æ²¡æœ‰æå®šï¼Œæœ€åç»ˆäºåœ¨ä¸€ä¸ª<a href="https://gist.github.com/coltenkrauter/608cfe02319ce60facd76373249b8ca6">gist</a>çš„è¯„è®ºä¸‹é¢æ‰¾åˆ°äº†è§£å†³æ–¹æ³•ã€‚</p>
<p>ä¸‹é¢çš„<code>$</code>å‘½ä»¤æŒ‡ç¤ºåœ¨Linuxä¸‹çš„å‘½ä»¤, <code>^$</code>æŒ‡ç¤ºWindowsä¸‹çš„å‘½ä»¤.</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>/etc
$<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;[network]&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>wsl.conf
$<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;generateResolvConf = false&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>-a<span class="w"> </span>wsl.conf<span class="w"> </span>

^$<span class="w"> </span>wsl<span class="w"> </span>--terminate

$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>/etc
$<span class="w"> </span>sudo<span class="w"> </span>rm<span class="w"> </span>-Rf<span class="w"> </span>resolv.conf<span class="w"> </span>


<span class="c1"># ä¸‹é¢åœ¨Windowsä¸‹æŸ¥æ‰¾ä¸»æœºæ‰€ç”¨çš„DNSè§£æIP</span>
^$<span class="w"> </span>ipconfig<span class="w"> </span>/all<span class="w"> </span>

<span class="c1"># å°†ä¸Šä¸€æ­¥æ‰¾åˆ°çš„DNSè§£ææ›¿æ¢åˆ°ä¸‹é¢çš„xxxxå†…</span>
$<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;nameserver X.X.X.X&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>resolv.conf
$<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;nameserver X.X.X.X&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>-a<span class="w"> </span>resolv.conf

^$<span class="w"> </span>wsl<span class="w"> </span>--terminate

$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>/etc
$<span class="w"> </span>sudo<span class="w"> </span>chattr<span class="w"> </span>+i<span class="w"> </span>resolv.conf
</code></pre></div>

<h2>SSHä¼šè¯å¤ç”¨</h2>
<p>åœ¨å†…ç½‘ä¸­ä¼šæœ‰å„ç§è·³æ¿æœºï¼Œè·³æ¿æœºè®¤è¯åˆæ˜¯å„ç§tokenï¼Œæ¯æ¬¡è¿æ–°æœºå™¨éƒ½éœ€è¦é‡è¿ä¸€æ¬¡è·³æ¿æœºï¼Œè¿™ä¸ªè¿‡ç¨‹ç¹çåˆæ— è¶£ï¼Œå…è®¤è¯çš„å†…éƒ¨å·¥å…·åˆä¸æ˜¯å¾ˆå¥½ç”¨ã€‚</p>
<p>ä¼šè¯å¤ç”¨èƒ½è®©åœ¨å·²æœ‰ä¸€ä¸ªè·³æ¿æœºè¿æ¥åï¼Œåç»­çš„è¿æ¥æ— éœ€å†æ¬¡è®¤è¯ã€‚</p>
<div class="highlight"><pre><span></span><code><span class="c1"># ~/.ssh/config</span>
Host<span class="w"> </span>*
<span class="w">    </span>ControlMaster<span class="w"> </span>auto
<span class="w">    </span>ControlPath<span class="w"> </span>~/.ssh/sockets/%r@%h-%p
<span class="w">    </span>ControlPersist<span class="w"> </span><span class="m">600</span>
</code></pre></div>

<p>è®°å¾—åˆ›å»ºæ–‡ä»¶å¤¹</p>
<div class="highlight"><pre><span></span><code>mkdir<span class="w"> </span>~/.ssh/sockets
</code></pre></div>

<h2>é…ç½®WSL2 &amp; Clion</h2>
<p>åé¢çš„å¼€å‘ä¸­å¸Œæœ›èƒ½ç”¨Clionè¿æ¥åˆ°WSL2çš„ç¯å¢ƒé‡Œï¼Œè¿™é‡Œç”¨Clionç»™çš„WSL2çš„é…ç½®è„šæœ¬ã€‚</p>
<div class="highlight"><pre><span></span><code>wget<span class="w"> </span>https://raw.githubusercontent.com/JetBrains/clion-wsl/master/ubuntu_setup_env.sh<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>bash<span class="w"> </span>ubuntu_setup_env.sh
</code></pre></div>

<h2>è§£å†³WSL2æŒ‚è½½Windowsç£ç›˜çš„gitæƒé™é—®é¢˜</h2>
<p>å› ä¸ºä¸€äº›å†…ç½‘çš„é™åˆ¶ï¼Œè¿™é‡Œéœ€è¦å°†ä»£ç æ”¾åˆ°Windowsçš„ç¡¬ç›˜ä¸Šæ‰èƒ½æ–¹ä¾¿ä¸è¿œç¨‹ç¯å¢ƒè¿›è¡Œä»£ç åŒæ­¥ã€‚
åœ¨WSL2æŒ‚è½½çš„Windowsç£ç›˜ä¸­æ‰§è¡Œgit cloneä¼šæœ‰æƒé™é—®é¢˜.</p>
<blockquote>
<p>NTFS partitions do not support chmod or similar Linux permissions commands</p>
</blockquote>
<p>æ ¹æ®ä¸‡èƒ½çš„StackOverflowï¼Œè¿™é‡Œåº”è¯¥åœ¨æŒ‚è½½çš„æ—¶å€™æŒ‡å®šmetaé€‰é¡¹, å‘/etc/wsl.confæ–‡ä»¶æ·»åŠ </p>
<div class="highlight"><pre><span></span><code><span class="c1"># /etc/wsl.conf </span>
<span class="o">[</span>automount<span class="o">]</span>
<span class="nv">options</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;metadata&quot;</span>
</code></pre></div>

<h2>ZSH</h2>
<h3>oh-my-zsh</h3>
<div class="highlight"><pre><span></span><code>sh<span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>curl<span class="w"> </span>-fsSL<span class="w"> </span>https://raw.github.com/ohmyzsh/ohmyzsh/master/tools/install.sh<span class="k">)</span><span class="s2">&quot;</span>
</code></pre></div>

<h3>zsh-autosuggestions</h3>
<p>è®¾ç½®zshè‡ªåŠ¨è¡¥å…¨</p>
<div class="highlight"><pre><span></span><code>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/zsh-users/zsh-autosuggestions<span class="w"> </span><span class="si">${</span><span class="nv">ZSH_CUSTOM</span><span class="k">:-</span><span class="p">~/.oh-my-zsh/custom</span><span class="si">}</span>/plugins/zsh-autosuggestions
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="nv">plugins</span><span class="o">=(</span>zsh-autosuggestions<span class="o">)</span>
</code></pre></div>

<h3>pip3 package command not found</h3>
<div class="highlight"><pre><span></span><code><span class="c1"># .zshrc</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">PATH</span><span class="o">=</span><span class="nv">$HOME</span>/.local/bin:<span class="nv">$PATH</span>
</code></pre></div>

<h2>TMUX</h2>
<p>tmuxè®¾ç½®é»˜è®¤shell</p>
<div class="highlight"><pre><span></span><code><span class="c1"># ~/.tmux.conf</span>
set-option<span class="w"> </span>-g<span class="w"> </span>default-shell<span class="w"> </span>/bin/zsh
</code></pre></div>
    </div><!-- /.entry-content -->


  </article>


</section>

<div id="comments">
  <h2 style="margin-top: 0.1rem;">Comments !</h2>
  <div id="gitalk-container"></div>
</div>
<script>
  var gitalk = new Gitalk({
    clientID: '4dfbf5aad180623dc634',
    clientSecret: '4c7167883746062103d9dbc2ec8b1ddfd6780d58',
    repo: 'steermomo.github.io',
    owner: 'steermomo',
    admin: ['steermomo'],
    id: location.pathname,      // Ensure uniqueness and length less than 50
    distractionFreeMode: false,  // Facebook-like distraction free mode
    createIssueManually: true,
  })
  gitalk.render('gitalk-container')
</script>
        <section id="extras" class="body">
        </section><!-- /#extras -->
<footer id="contentinfo" class="body">
  <address id="about" class="vcard body">
    Copyright Â© 2024
    </br>
    Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a
      href="http://python.org">Python</a>.
  </address>

  <!-- /#about -->


</footer><!-- /#contentinfo -->



</body>

</html>